# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

DSGRN_utils is a Python package that extends DSGRN (Dynamic Signatures Generated by Regulatory Networks) with utilities for analyzing and visualizing regulatory networks and their dynamics. The project focuses on computational biology applications, particularly analyzing gene regulatory networks through Morse graphs and phase space analysis.

## Development Setup

```bash
# Install in development mode
pip install -e .

# Install dependencies if not already installed
pip install DSGRN pyCHomP2
```

## Architecture and Key Components

### Core Modules

The package is organized under `src/DSGRN_utils/` with the following key components:

1. **Morse Graph Analysis**
   - `ComputeMorseGraph.py`: Computes Morse graphs from network parameters using Conley theory
   - `MorseGraph.py`: Core Morse graph data structures and algorithms
   - `PlotMorseGraph.py`: Visualizes Morse graph structure with networkx
   - `PlotMorseSets.py`: Visualizes Morse sets in phase space projections

2. **State Space Analysis**
   - `CubicalBlowupGraph.py`: Creates state transition graphs from regulatory network parameters
   - `WallLabelling.py`: Handles wall labellings for phase space decomposition
   - `RampFunction.py`: Implements ramp systems functionality for regulatory dynamics

3. **Query Tools**
   - `StabilityQuery.py`: Analyzes stability of attractors across parameter space
   - `IsomorphismQuery.py`: Checks for graph isomorphisms in network structures

### Key Integration Points

- All visualization functions expect DSGRN parameter objects and return matplotlib figures
- Morse graph computations use pyCHomP2 for topological analysis
- Functions typically accept DSGRN.Parameter objects and return specialized data structures

## Common Development Tasks

### Working with Boolean Networks

```python
import DSGRN
import DSGRN_utils

# Define network
network = DSGRN.Network("v1 : ~v2\nv2 : ~v1")
parameter_graph = DSGRN.ParameterGraph(network)
parameter = parameter_graph.parameter(index)

# Compute and visualize Morse graph
morse_graph, stg, graded_complex = DSGRN_utils.ConleyMorseGraph(parameter)
DSGRN_utils.PlotMorseGraph(morse_graph)
DSGRN_utils.PlotMorseSets(morse_graph, stg, graded_complex)
```

### Figure Generation

Figures should be saved to organized directories:
- Use `figures/` for generated plots
- Include descriptive filenames with parameters used
- Set consistent DPI and formatting for publication quality

## Important Implementation Notes

1. **Performance Considerations**: Morse graph computations can be expensive for large networks. The code includes timing measurements in examples.

2. **Visualization Defaults**: PlotMorseSets uses specific color settings and arrow styles that should be preserved for consistency.

3. **Parameter Indexing**: DSGRN uses specific parameter indexing schemes. When working with partial orders, use `DSGRN.index_from_partial_orders()` for correct parameter selection.

4. **Recent Changes**: Recent commits have modified Morse graph node sorting and added ramp systems functionality. Be aware of these when working with older code.